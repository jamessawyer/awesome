ç›®å½•ï¼š

1. [Cheat sheet: lookaround assertions](#1)
2. [Warnings for this chapter](#2)
3. [Example: Specifying what comes before or after a match(position lookaround)](#3)
4. [Example: Specifying what does not come before or after a match(negative lookaroundd)](#4)
   1. [There are no simple alternatives to negative lookaround assertions](#4.1)
5. [Interlude: pointing lookaround assertions inward](#5)
6. [Example: match substrings that do not contain '.mjs'](#6)
7. [Example: match strings not starting with 'abc'](#7)
8. [Example: skipping lines with comments](#8)
9. [Example: smart quotes](#9)
   1. [Supporting escaping via backslashes](#9.1)
10. [Acknowledgements](#10)
11. [Further reading](#11)



æœ¬ç« å°†ä½¿ç”¨ç¤ºä¾‹æ¢ç´¢æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ **ç¯è§†æ–­è¨€ï¼ˆ`lookaround assertions`ï¼‰**ã€‚*ç¯è§†æ–­è¨€æ˜¯éæ•è·çš„ï¼Œå¹¶ä¸”å¯¹è¾“å…¥å­—ç¬¦ä¸²å½“å‰ä½ç½®çš„å‰æˆ–åï¼Œå¿…é¡»åŒ¹é…ï¼ˆæˆ–è€…ä¸åŒ¹é…ï¼‰* ã€‚ğŸ”¥



<p id="1"></p>



## 1ï¸âƒ£ â­ Cheatsheet: ç¯è§†æ–­è¨€

å¯ç”¨ç¯è§†æ–­è¨€åˆ—è¡¨ï¼š

| æ¨¡å¼             | åç§°                                  |        |
| ---------------- | ------------------------------------- | ------ |
| `(?=Â«patternÂ»)`  | å…ˆè¡Œæ–­è¨€ï¼ˆ`Positive lookahead`ï¼‰      | ES3    |
| `(?!Â«patternÂ»)`  | æ­£å‘å¦å®šæŸ¥æ‰¾ï¼ˆ`Negative lookahead`ï¼‰  | ES3    |
| `(?<=Â«patternÂ»)` | åè¡Œæ–­è¨€ï¼ˆ`Positive lookbehind`ï¼‰     | ES2018 |
| `(?<!Â«patternÂ»)` | åå‘å¦å®šæŸ¥æ‰¾ï¼ˆ`Negative lookbehind`ï¼‰ | ES2018 |

æœ‰4ç§ç¯è§†æ–­è¨€ï¼š

- æ­£å‘æ–­è¨€ï¼ˆ`Lookahead assertions`ï¼‰ ES3: å³æ¨¡å¼åœ¨åï¼ŒåŒ¹é…å‰é¢çš„å†…å®¹ï¼Œ `/x(?=y)/` | `x(?!y)`
  - å…ˆè¡Œæ–­è¨€ï¼ˆ`Positive lookahead`ï¼‰:  `(?=Â«patternÂ»)` å¦‚æœæ¨¡å¼**åŒ¹é…**è¾“å…¥å­—ç¬¦ä¸²ä¸­å½“å‰ä½ç½®**ä¹‹å**çš„å†…å®¹ï¼Œåˆ™åŒ¹é…ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šğŸŒ° `/Jack(?=Sprat)/` åªæœ‰ `Jack` åé¢è·Ÿç€ `Sprat` æ—¶æ‰åŒ¹é… `Jack`ï¼›æ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸² `JackSprat` å°±èƒ½åŒ¹é…ä¸Šï¼Œè€Œ `JackMike` ä¸èƒ½åŒ¹é…ä¸Šï¼‰
  - æ­£å‘å¦å®šæŸ¥æ‰¾ï¼ˆ`Negative lookahead`ï¼‰ï¼š`(?!Â«patternÂ»)` å¦‚æœæ¨¡å¼**ä¸åŒ¹é…**è¾“å…¥å­—ç¬¦ä¸²ä¸­å½“å‰ä½ç½®**ä¹‹å**çš„å†…å®¹ï¼Œåˆ™åŒ¹é…ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šğŸŒ° `/Jack(?!Sprat)/` åªæœ‰ `Jack` åé¢è·Ÿç€çš„ä¸æ˜¯ `Sprat` æ—¶æ‰åŒ¹é… `Jack`ï¼Œæ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸² `JackMike` å°±èƒ½åŒ¹é…ä¸Šï¼Œè€Œ `JackSprat` ä¸èƒ½åŒ¹é…ä¸Šï¼‰
- åå‘æ–­è¨€ï¼ˆ`Lookbehind assertions`ï¼‰ ES2018: å³æ¨¡å¼åœ¨å‰ï¼ŒåŒ¹é…åé¢çš„å†…å®¹ï¼Œ`/(?<=y)x/` | `(?<!y)x`
  - åè¡Œæ–­è¨€ï¼ˆ`Positive lookbehind`ï¼‰ï¼š `(?<=Â«patternÂ»)` å¦‚æœæ¨¡å¼**åŒ¹é…**è¾“å…¥å­—ç¬¦ä¸²ä¸­å½“å‰ä½ç½®**ä¹‹å‰**çš„å†…å®¹ï¼Œåˆ™åŒ¹é…ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šğŸŒ° `/(?<=Jack)Sprat/` åªæœ‰ `Sprat` å‰é¢è·Ÿç€ `Jack` æ—¶æ‰åŒ¹é… `Sprat`ï¼›æ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸² `JackSprat` å°±èƒ½åŒ¹é…ä¸Šï¼Œè€Œ `TomasSprat` ä¸èƒ½åŒ¹é…ä¸Šï¼‰
  - åå‘å¦å®šæŸ¥æ‰¾ï¼ˆ`Negative lookbehind`ï¼‰ï¼š `(?<!Â«patternÂ»)` å¦‚æœæ¨¡å¼**ä¸åŒ¹é…**è¾“å…¥å­—ç¬¦ä¸²ä¸­å½“å‰ä½ç½®**ä¹‹å‰**çš„å†…å®¹ï¼Œåˆ™åŒ¹é…ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šğŸŒ° `/(?<!Jack)Sprat/` åªæœ‰ `Sprat` å‰é¢è·Ÿç€çš„ä¸æ˜¯ `Jack` æ—¶æ‰åŒ¹é… `Sprat`ï¼›æ¯”å¦‚è¾“å…¥å­—ç¬¦ä¸² `ThomasSprat` å°±èƒ½åŒ¹é…ä¸Šï¼Œè€Œ `JackSprat` ä¸èƒ½åŒ¹é…ä¸Šï¼‰



<p id="2"></p>



## 2ï¸âƒ£ æœ¬ç« è­¦å‘Š

- ç¤ºä¾‹å±•ç¤ºå¯ä»¥é€šè¿‡ç¯è§†æ–­è¨€èƒ½å®Œæˆä»»åŠ¡ã€‚ä½†æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸æ€»æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚å…¶ä»–æŠ€æœ¯ï¼Œæ¯”å¦‚åˆé€‚çš„è§£æï¼Œå¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚
- **åå‘æ–­è¨€** æ˜¯ä¸€ç§ç›¸å¯¹æ–°çš„æŠ€æœ¯ï¼Œæœ‰å¯èƒ½ä¸è¢«æ‰€æœ‰çš„JSå¼•æ“æ‰€æ”¯æŒ
- ç¯è§†æ–­è¨€å¯èƒ½å½±å“æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å¯¹é•¿å­—ç¬¦ä¸²çš„åŒ¹é…



<p id="3"></p>



## 3ï¸âƒ£ ä¾‹å­ï¼šæŒ‡å®šä»€ä¹ˆèƒ½åœ¨åŒ¹é…å‰æˆ–è€…åï¼ˆè‚¯å®šç¯è§†ï¼‰

ä¸‹é¢ä¾‹å­ï¼Œæˆ‘ä»¬æå–å¼•å·å†…çš„å•è¯ï¼š

```js
'how "are" "you" doing'.match(/(?<=")[a-z]+(?=")/g)

// ['are', 'you']
```

2ä¸ªç¯è§†æ–­è¨€å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™ä¸€ä»»åŠ¡ï¼š

1. `(?<=")` åè¡Œæ–­è¨€ï¼Œå³å¿…é¡»åœ¨å‰é¢åŠ å¼•å· `"xxx`
2. `(?=")` å…ˆè¡Œæ–­è¨€ï¼Œå³å¿…é¡»åé¢è·Ÿç€å¼•å· `xxx"`

å³è¢«åŒ¹é…çš„å­—ç¬¦ä¸²å‰åéƒ½å¿…é¡»æœ‰å¼•å·ï¼Œåªæœ‰ä¸Šé¢çš„ `are` & `you` æ»¡è¶³åŒ¹é…ã€‚

ç¯è§†æ–­è¨€å¯¹ `.match()` åœ¨ `/g` æ¨¡å¼ä¸‹ç‰¹åˆ«æ–¹ä¾¿ï¼Œå®ƒä¼šè¿”å›æ•´ä¸ªåŒ¹é…ï¼ˆæ•è·ç»„ `0`ï¼‰ã€‚**æ— è®ºç¯è§†æ–­è¨€åŒ¹é…çš„æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸ä¼šè¢«æ•è·ã€‚ğŸ“š** å¦‚æœä¸ä½¿ç”¨ç¯è§†æ–­è¨€ï¼Œåˆ™å¼•å·ä¹Ÿä¼šè¢«åŒ…å«åˆ°åŒ¹é…ç»“æœä¸­å»ï¼š

```js
'how "are" "you" doing'.match(/"([a-z]+)"/g)

['"are"', '"you"']
```



<p id="4"></p>

## 4ï¸âƒ£ ç¤ºä¾‹ï¼šæŒ‡å®šä»€ä¹ˆä¸èƒ½åœ¨åŒ¹é…å‰æˆ–è€…åï¼ˆå¦å®šç¯è§†ï¼‰

å¦‚æœæƒ³å–å¾—å’Œä¸Šé¢ä¾‹å­ç›¸åçš„ç»“æœï¼Œæå–æ‰€æœ‰æ²¡æœ‰è¢«å­—ç¬¦ä¸²åŒ…è£¹çš„éƒ¨åˆ†ï¼Ÿ

- è¾“å…¥ï¼š `'how "are" "you" doing'`
- è¾“å‡ºï¼š`['how', 'doing']`

æˆ‘ä»¬ç¬¬ä¸€æ¬¡å°è¯•ï¼Œç®€å•çš„å°†è‚¯å®šç¯è§†æ–­è¨€è½¬æ¢ä¸ºå¦å®šç¯è§†æ–­è¨€ã€‚ä½†è¿™ä¼šå¤±è´¥ï¼š

```js
'how "are" "you" doing'.match(/(?<!")[a-z]+(?!")/g)

['how', 'r', 'o', 'doing']
```

é—®é¢˜åœ¨äºæˆ‘ä»¬æå–çš„å­—ç¬¦åºåˆ—æ˜¯æ²¡æœ‰è¢«å¼•å·æ‹¬èµ·æ¥ã€‚æ„å‘³ç€åœ¨å­—ç¬¦ä¸² `'"are"'`çš„ `r` åœ¨ä¸­é—´ä¹Ÿè¢«è®¤ä¸ºå‰åæ²¡æœ‰å¼•å·æ‹¬èµ·æ¥ï¼Œå› ä¸ºå®ƒå‰é¢æ˜¯ `a`ï¼Œåé¢æ˜¯ `e`ï¼Œå®Œå…¨æ»¡è¶³åŒ¹é…æ¨¡å¼ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡é™å®šå‰ç¼€åç¼€å¿…é¡»æ—¢ä¸æ˜¯å¼•å·ä¹Ÿä¸æ˜¯å­—æ¯æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼š

```js
'how "are" "you" doing'.match(/(?<!["a-z])[a-z]+(?!["a-z])/g)

['how', 'doing']
```

ğŸ’¡å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡`\b`è¦æ±‚å­—ç¬¦åºåˆ—`[a-z]+`ä»¥å•è¯è¾¹ç•Œå¼€å§‹å’Œç»“æŸ:

```js
'how "are" "you" doing'.match(/(?<!")\b[a-z]+\b(?!")/g)

['how', 'doing']
```

å…³äº **åå‘å¦å®šæŸ¥æ‰¾ï¼ˆ`negative lookbehind`ï¼‰** å’Œ **æ­£å‘å¦å®šæŸ¥æ‰¾ï¼ˆ`negative lookahead`ï¼‰** å¾ˆæ£’çš„ç‚¹åœ¨äºï¼Œå®ƒä»¬å„è‡ªéƒ½æ”¯æŒåœ¨å­—ç¬¦ä¸²çš„å¼€å¤´æˆ–å­—ç¬¦ä¸²çš„ç»“å°¾ - æ­£å¦‚ç¤ºä¾‹æ‰€ç¤º.



<p id="4.1"></p>

### 4.1 å¦å®šç¯è§†æ–­è¨€æ²¡æœ‰ç®€å•çš„æ›¿ä»£æ–¹æ¡ˆ



å¦å®šç¯è§†æ–­è¨€æ˜¯ä¸€ç§å¾ˆå¼ºå¤§çš„å·¥å…·ï¼Œé€šå¸¸ä¸å¤ªå¯èƒ½é€šè¿‡å…¶å®ƒæ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ¨¡æ‹Ÿã€‚

å¦‚æœæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨å®ƒä»¬ï¼Œæˆ‘ä»¬é€šå¸¸å¿…é¡»é‡‡å–ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ‰å¼•å·çš„å’Œæ²¡æœ‰å¼•å·çš„å•è¯è¿›è¡Œæ‹†åˆ†ï¼Œç„¶åè¿‡æ»¤ï¼š

```js
const str = 'how "are" "you" doing'

const allWords = str.match(/"?[a-z]+"?/g)
// allWords -> ['how', '"are"', '"you"', 'doing']

// ä¸å¸¦å¼•å·çš„
const unquoteWords = allWords.filter(
  w => !w.startsWith('"') || !w.endsWith('"')
)
// ['how', 'doing']
```

è¿™ç§æ–¹å¼çš„å¥½å¤„ï¼š

- å¯¹è€çš„JSå¼•æ“å‹å¥½
- æ˜“äºç†è§£



<p id="5"></p>



## 5ï¸âƒ£ æ’æ›²: æŒ‡æŒ‡å››å‘¨ï¼Œæ–­è¨€å‘å†…

æˆ‘ä»¬ç›®å‰æ‰€è§çš„æ‰€æœ‰ä¾‹å­éƒ½æœ‰ä¸ªå…±åŒç‚¹ï¼Œç¯è§†æ–­è¨€è§„å®šåŒ¹é…ä¹‹å‰æˆ–ä¹‹åå¿…é¡»å‡ºç°ä»€ä¹ˆå­—ç¬¦ï¼Œä½†ä¸åŒ…æ‹¬åŒ¹é…ä¸­çš„è¿™äº›å­—ç¬¦ã€‚

æœ¬ç« åç»­éƒ¨åˆ†å±•ç¤ºçš„æ­£åˆ™è¡¨è¾¾å¼æœ‰æ‰€ä¸åŒï¼šå®ƒä»¬çš„ç¯è§†æ–­è¨€æŒ‡å‘å†…éƒ¨ï¼Œå¹¶é™åˆ¶åŒ¹é…å†…éƒ¨çš„å†…å®¹ã€‚



<p id="6"></p>



## 6ï¸âƒ£ ç¤ºä¾‹ï¼šåŒ¹é…ä¸ä»¥ `abc` å¼€å¤´çš„å­—ç¬¦ä¸²



å‡è®¾æˆ‘ä»¬æƒ³åŒ¹é…æ‰€æœ‰ä¸ä»¥ `abc` å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬é¦–å…ˆå°è¯•çš„æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½æ˜¯ `/^(?!abc)/`ã€‚

è¿™å¯¹ `.test()` æ­£å¸¸å·¥ä½œï¼š

```js
/^(?!abc)/.test('xyz')

// true
```

ä½†æ˜¯ `.exec()` è¿”å›ç©ºå­—ç¬¦ä¸²ğŸ˜…ï¼š

```js {3}
/^(?!abc)/.exec('xyz')

{0: '', index: 0, input: 'xyz', groups: undeinfed}
```

ğŸ“š **é—®é¢˜åœ¨äºï¼Œæ–­è¨€ï¼Œæ¯”å¦‚ç¯è§†æ–­è¨€ï¼Œä¸ä¼šæ‰©å±•åŒ¹é…çš„æ–‡å­—ã€‚** å³ï¼Œå®ƒä»¬ä¸ä¼šæ•è·è¾“å…¥å­—ç¬¦ï¼Œå®ƒä»¬ä»…ä»…å¯¹è¾“å…¥çš„å½“å‰ä½ç½®æå‡ºè¦æ±‚ã€‚ğŸ”¥

å› æ­¤ï¼Œ*è§£å†³æ–¹å¼ä¾¿æ˜¯ï¼Œæ·»åŠ ä¸€ä¸ªæ¨¡å¼ç”¨äºæ•è·è¾“å…¥çš„å­—ç¬¦*ï¼š

```js {1}
/^(?!abc).*$/.exec('xyz')

{0: 'xyz', index: 0, input: 'xyz', groups: undeinfed}
```

æ­£å¦‚æƒ³è¦çš„ï¼Œè¿™ä¸ªæ–°æ­£åˆ™è¡¨è¾¾å¼æ‹’ç»ä»¥ `abc` ä½œä¸ºå‰ç¼€çš„å­—ç¬¦ä¸²ï¼š

```js
/^(?!abc).*$/.exec('abc') // null
/^(?!abc).*$/.exec('abcd') // null
```

å¹¶ä¸”å®ƒæ¥å—æ²¡æœ‰å®Œå…¨åŒ¹é…å‰ç¼€çš„å­—ç¬¦ä¸²ï¼š

```js
/^(?!abc).*$/.exec('ab')

{0: 'ab', index: 0, input: 'xyz', groups: undeinfed}
```



<p id="7"></p>



## 7ï¸âƒ£ ç¤ºä¾‹ï¼šåŒ¹é…ä¸åŒ…å« `.mjs` çš„å­å­—ç¬¦ä¸²

ä¸‹é¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åƒæ‰¾å‡ºï¼š

```js
import ... from 'Â«module-specifierÂ»';
```

`module-specifier` å¤„ä¸èƒ½ä»¥ `.mjs` ç»“å°¾ï¼š

```js {9}
const code = `
import {transform} from './util';
import {Person} from './person.mjs';
import {zip} from 'lodash';
`.trim()


assert.deepEqual(
  code.match(/^import .*? from '[^']+(?<!\.mjs)';$/umg),
  [
    "import {transform} from './util';",
    "import {zip} from 'lodash';",
  ])
```

è¿™é‡Œï¼Œåå‘å¦å®šæ–­è¨€ï¼ˆ`(?<!\.mjs)`ï¼‰ å……å½“ **å®ˆå«ï¼ˆ`guard`ï¼‰**ï¼Œé˜»æ­¢æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åœ¨æ­¤ä½ç½®åŒ…å« `.mjs` çš„å­—ç¬¦ä¸²ã€‚

è¯‘è€…æ³¨ï¼šä¸Šé¢çš„flags `umg` è¯´æ˜:

- `u`ï¼š åŒ¹é… unicode
- `m`ï¼š åŒ¹é…å¤šè¡Œ
- `g`ï¼š å…¨å±€åŒ¹é…



<p id="8"></p>



## 8ï¸âƒ£ ç¤ºä¾‹ï¼šè·³è¿‡åŒ…å«æ³¨é‡Šçš„è¡Œ

åœºæ™¯ï¼šæˆ‘ä»¬åƒè§£æåŒ…å«è®¾ç½®çš„è¡Œï¼Œè·³è¿‡æ³¨é‡Šã€‚æ¯”å¦‚ï¼š

```js
const RE_SETTING = /^(?!#)([^:]*):(.*)$/

const lines = [
  'indent: 2', // setting
  '# Trim trailing whitespace:', // comment
  'whitespace: trim', // setting
]

for (const line of lines) {
  const match = RE_SETTING.exec(line);
  if (match) {
    const key = JSON.stringify(match[1]);
    const value = JSON.stringify(match[2]);
    console.log(`KEY: ${key} VALUE: ${value}`);
  }
}

// è¾“å‡º
// 'KEY: "indent" VALUE: " 2"'
// 'KEY: "whitespace" VALUE: " trim"'
```

æˆ‘ä»¬å¦‚ä½•åˆ°è¾¾æ­£åˆ™è¡¨è¾¾å¼ `RE_SETTING` çš„ï¼Ÿ

æˆ‘ä»¬å¯¹settingsä½¿ç”¨ä¸‹é¢æ­£åˆ™è¡¨è¾¾å¼ï¼š

```js
/^([^:]*):(.*)$/
```

å¾ˆç›´è§‰çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«ä¸‹é¢éƒ¨åˆ†çš„åºåˆ—ï¼š

- è¿™è¡Œçš„å¼€å§‹ä½ç½®
- é `:` ï¼ˆ0è‡³å¤šä¸ªï¼‰
- å•ä¸ª `:`
- ä»»æ„å­—ç¬¦ ï¼ˆ0è‡³å¤šä¸ªï¼‰
- ç»“å°¾ä½ç½®

è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¼šå¦å®šæŸäº›comments:

```js
/^([^:]*):(.*)$/.test('# Comment')
// false
```

ä½†æ˜¯ä¼šæ¥å—å…¶å®ƒçš„ï¼ˆåŒ…å«å†’å·çš„ï¼‰ï¼š

```js
/^([^:]*):(.*)$/.test('# Comment:')
// true
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  `(?!#)` å‰ç¼€ä½œä¸ºå®ˆå«ã€‚ç›´è§‰ä¸Šï¼Œå®ƒè¡¨ç¤ºï¼šè¾“å…¥å­—ç¬¦ä¸²ä¸­çš„å½“å‰ä½ç½®ä¸èƒ½åè·Ÿå­—ç¬¦`#`ã€‚

æ–°çš„æ­£åˆ™è¡¨è¾¾å¼æ­£å¦‚æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼šğŸ˜

```js
/^(?!#)([^:]*):(.*)$/.test('# Comment:')
// false
```



<p id="9"></p>



## 9ï¸âƒ£ ç¤ºä¾‹ï¼šæ™ºèƒ½å¼•å·

å‡å¦‚æˆ‘ä»¬æƒ³è¦å…è®¸ä¸‹é¢é€šè¿‡åæ–œæ ï¼ˆ`\` ï¼‰è½¬ä¹‰çš„å¼•å·æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨å¼•å·å‰ä½¿ç”¨ `(?<!\\)` å®ˆå«ï¼š

```js
const regExp = /(?<!\\)"(.*?)(?<!\\)"/g
String.raw`\"straight\" andd "curly"`.replace(regExp, '{$1}')
'\\"straight\\" and {curly}'
```

ä½œä¸ºåå¤„ç†æ­¥éª¤ï¼Œæˆ‘ä»¬ä»éœ€è¦åšï¼š

```js
.replace(/\\"/g, `"`)
// '"straight" and {curly}'
```

ç„¶åï¼Œæ­£åˆ™è¡¨è¾¾å¼å¯èƒ½å¤±è´¥ï¼Œå½“å­˜åœ¨åæ–œæ è‡ªå·±çš„è½¬ä¹‰æ—¶ï¼š

```js
String.raw`Backslash: "\\"`.replace(/(?<!\\)"(.*?)(?<!\\)"/g, '{$1}')

'Backslash: "\\\\"'
```

ç¬¬äºŒä¸ª `\` æ³¨é‡äº†å¼•å·å˜ä¸º `{}`ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å®ˆå«å˜å¾—æ›´å¤æ‚æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼ˆğŸ’¡ `?:` è¡¨ç¤ºä½¿ç»„å˜ä¸ºä¸å¯æ•è·ï¼‰ï¼š

```js
(?<=[^\\](?:\\\\)*)
```

æ–°çš„å®ˆå«å…è®¸å¼•å·å‰å‡ºç°æˆå¯¹çš„ `\`:

```js
const regExp = /(?<=[^\\](?:\\\\)*)"(.*?)(?<=[^\\](?:\\\\)*)"/g

String.raw`Backslash: "\\"`.replace(regExp, '{$1}')
'Backslash: {\\\\}'
```

æˆ‘ä»¬çš„é—®é¢˜ä»æ—§å­˜åœ¨ã€‚è¿™ä¸ªå®ˆå«é˜»æ­¢ç¬¬ä¸€ä¸ªå¼•å·å¦‚æœå‡ºç°åœ¨å¼€å¤´æ—¶è¢«åŒ¹é…ï¼š

```js
const regExp = /(?<=[^\\](?:\\\\)*)"(.*?)(?<=[^\\](?:\\\\)*)"/g

`"abc"`.replace(regExp, '{$1}')
// '"abc"'
```

æˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€ä¸ªå®ˆå«å˜ä¸ºï¼š `(?<=[^\\](?:\\\\)*)|^`:

```js
const regExp = /(?<=[^\\](?:\\\\)*|^)"(.*?)(?<=[^\\](?:\\\\)*)"/g

`"abc"`.replace(regExp, '{$1}')

// '{abc}'
```



<p id="10"></p>



## ğŸ”Ÿ é¸£è°¢

- ç¬¬ä¸€ä¸ªå¤„ç†è½¬ä¹‰ `\` å‰çš„å¼•å·çš„æ­£åˆ™è¡¨è¾¾å¼æ¥è‡ª [jonasraoni Twitter](https://twitter.com/jonasraoni/status/992506010454683650)



## 1ï¸âƒ£1ï¸âƒ£ è¿›ä¸€æ­¥é˜…è¯»

- [Regular expressions (RegExp)](https://exploringjs.com/impatient-js/ch_regexps.html) JS for impatient programmers

è¯‘è€…æ³¨ï¼š

1. [MDN RegExp ä¸­æ–‡ç‰ˆ](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions) å¯ä»¥æŸ¥çœ‹ä¸Šé¢æœ¯è¯­çš„ä¸­æ–‡ç¿»è¯‘ï¼Œä»¥åŠç®€å•çš„ç¤ºä¾‹ï¼Œå¸®åŠ©ç†è§£
2. [regex101 æ­£åˆ™å¯è§†åŒ–](https://regex101.com/)





2022å¹´08æœˆ01æ—¥22:58:09

