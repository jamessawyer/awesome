- äº‹ä»¶æµ: å†’æ³¡å’Œæ•è·
- äº‹ä»¶å¤„ç†ï¼š **`addEventListener`**
- äº‹ä»¶ç±»å‹ï¼šUIEvents, é¼ æ ‡ï¼Œé”®ç›˜ï¼Œè¾“å…¥ï¼Œç„¦ç‚¹äº‹ä»¶ç­‰
  - **`target` ** vs **`currentTarget`** åŒºåˆ«
  - **`mouseout`** vs **`mouseleave`** & **`mouseenter`** vs **`mouseover`** åŒºåˆ«
  - **`clientX & pageX & screenX & offsetX`** åŒºåˆ«
  - é¼ æ ‡äº‹ä»¶ï¼ŒåŒ…å« **`button`** å±æ€§ï¼Œå¯ä»¥ç”¨æ¥ç¡®è®¤æ˜¯é¼ æ ‡çš„å“ªä¸€ä¸ªé”®ç‚¹å‡»çš„
  - å¦‚ä½•ä½¿ç”¨ **`onload`** ä¸‹è½½ image
  - **`hashchange`** äº‹ä»¶
- äº‹ä»¶å§”æ‰˜
- è‡ªå®šä¹‰äº‹ä»¶: **`CustomEvent()`**

ä¹¦æœ¬ä¸­è¿˜æåˆ°äº†è®¾å¤‡äº‹ä»¶å’Œè§¦æ‘¸æ‰‹åŠ¿ï¼Œè¿™é‡Œæ²¡æœ‰æåˆ°ã€‚



ğŸ§ğŸ§ğŸ§  ï¼š è¡¨ç¤ºæå‡ºçš„æ€è€ƒå’ŒTips

âœ¨âœ¨âœ¨: è¡¨ç¤ºæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ

âš¡ï¸ï¼š è¡¨ç¤ºé‡ç‚¹å†…å®¹

## 1. äº‹ä»¶æµ

è¿™ä¸ªæ¯”è¾ƒå¸¸è§„çš„2ç§äº‹ä»¶ä¼ é€’æ–¹å‘ï¼š

1. äº‹ä»¶å†’æ³¡ï¼ˆbubbleï¼‰ï¼ˆæ²¿ç€DOMæ ‘å‘ä¸Šä¼ é€’ï¼‰
2. äº‹ä»¶æ•è·ï¼ˆcaptureï¼‰ï¼ˆä»ä¸Šå‘ä¸‹ä¼ é€’ï¼‰ï¼šç”¨äºäº‹ä»¶æ‹¦æˆª

<img src="images/ch17/1.äº‹ä»¶æµ.jpg" alt="1.äº‹ä»¶æµ" style="zoom:50%;" />



## 2. äº‹ä»¶å¤„ç†

å¤„ç†æ–¹å¼æœ‰2ç§ï¼š

1. **`elem.oneventtype = function(e) {}`**: æ¯”å¦‚ **`div.onclick = function(e){}`**; ç§»é™¤handlerçš„æ–¹å¼ï¼š**`elem.oneventtype = null`**
2. **`elem.addEventListener(eventType, handler, isCapture = false)`**: é»˜è®¤ä½¿ç”¨ **å†’æ³¡äº‹ä»¶æµ**
   - ç‰¹ç‚¹ï¼šå¯¹ç›¸åŒçš„äº‹ä»¶ç±»å‹ï¼Œå¯ä»¥åŒæ—¶æ·»åŠ å¤šä¸ªlistenersï¼›ä¸Šé¢çš„ **`oneventtype`** å¯¹åŒä¸€ç±»å‹äº‹ä»¶åªèƒ½æ·»åŠ ä¸€ä¸ªlistenerï¼›
   - ç§»é™¤listenerï¼š **`removeEventListener(eventType, handler, isCapture = false)`**

ç¤ºä¾‹:

```js
const button = document.querySelector('#btn')
button.onclick = function(e) {
  console.log('onclick 1')
}
button.onclick = function(e) {
  console.log('onclick 2')
}

button.addEventListener('click', (e) => {
  console.log('click 1')
})

button.addEventListener('click', (e) => {
  console.log('click 2')
})

// ç‚¹å‡»æŒ‰é’®
// onclick 1 å¹¶ä¸ä¼šè¢«è§¦å‘
onclick 2
click 1
click 2
```

ğŸ§ğŸ§ğŸ§å…³äº [addEventListener - MDN](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener) å®ƒè¿˜æœ‰ä¸€äº›å…¶ä½™çš„ç”¨æ³•ï¼Œ æ¯”å¦‚ï¼šåªè§¦å‘ä¸€æ¬¡

```js
const btn = document.getElementById('btn')
btn.addEventListener('click', (e) => {
  console.log('fire')
}, {
  once: true // åªè§¦å‘ä¸€æ¬¡
})
```



## 3. äº‹ä»¶å¯¹è±¡

ä¸åŒç±»å‹çš„äº‹ä»¶ä¼šåŒ…å«ä¸åŒçš„å±æ€§ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„æ¥å£ **`Event`**, æœ‰å¦‚ä¸‹ä¸€äº›å…¬ç”¨å±æ€§ï¼š

```ts
interface Event {
    // åªè¯» äº‹ä»¶æ˜¯å¦å†’æ³¡
    readonly bubbles: boolean;
    
  	// åªè¯» è¡¨ç¤ºæ˜¯å¦å¯ä»¥å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸º
    readonly cancelable: boolean;
    /**
     * Returns true or false depending on how event was initialized. True if event invokes listeners past a ShadowRoot node that is the root of its target, and false otherwise.
     */
    readonly composed: boolean;
    
  	// âœ¨âœ¨âœ¨ åªè¯» å…ƒç´ ç±»å‹ å½“å‰äº‹ä»¶å¤„ç†ç¨‹åºæ‰€åœ¨çš„å…ƒç´ 
    readonly currentTarget: EventTarget | null;
    
  	// åªè¯» trueè¡¨ç¤ºå·²ç»è°ƒç”¨ preventDefault() æ–¹æ³•
    readonly defaultPrevented: boolean;
    
  	// âœ¨âœ¨âœ¨ è¡¨ç¤ºè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºçš„é˜¶æ®µï¼š 
  	// 1: CAPTURING_PHASEï¼ˆæ•è·é˜¶æ®µï¼‰, 2: AT_TARGETï¼ˆè¾¾åˆ°ç›®æ ‡ï¼‰, 3: BUBBLING_PHASEï¼ˆå†’æ³¡é˜¶æ®µï¼‰
    readonly eventPhase: number;
    
  	// true: è¡¨ç¤ºäº‹ä»¶ç”±æµè§ˆå™¨ç”Ÿæˆçš„ï¼›falseï¼šè¡¨ç¤ºäº‹ä»¶æ˜¯å¼€å‘è€…è‡ªå®šä¹‰çš„äº‹ä»¶
    readonly isTrusted: boolean;
    

    // âœ¨âœ¨âœ¨å…ƒç´  äº‹ä»¶ç›®æ ‡
    readonly target: EventTarget | null;
    
  	// äº‹ä»¶çš„ç±»å‹  e.g. "click", "hashchange", or "submit".
    readonly type: string;
    /**
     * Returns the invocation target objects of event's path (objects on which listeners will be invoked), except for any nodes in shadow trees of which the shadow root's mode is "closed" that are not reachable from event's currentTarget.
     */
    composedPath(): EventTarget[];
  	
  	// âœ¨âœ¨âœ¨åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶
    initEvent(type: string, bubbles?: boolean, cancelable?: boolean): void;
    
  	// å‡½æ•° å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸º åªæœ‰ cancelableä¸ºtrueæ—¶æ‰èƒ½è°ƒç”¨è¿™ä¸ªæ–¹æ³•
  	// æ¯”å¦‚ <a href='xx'></a> é»˜è®¤ä¼šè·³è½¬åˆ·æ–°é¡µé¢ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°é˜»æ­¢è¿™ä¸€é»˜è®¤è¡Œä¸º
    preventDefault(): void;
    // ç”¨äºå–æ¶ˆæ‰€æœ‰åç»­æ•è·æˆ–äº‹ä»¶å†’æ³¡ å¹¶é˜»æ­¢è°ƒç”¨ä»»ä½•åç»­äº‹ä»¶å¤„ç†ç¨‹åº
    stopImmediatePropagation(): void;
    // ç”¨äºå–æ¶ˆæ‰€æœ‰åç»­æ•è·æˆ–äº‹ä»¶å†’æ³¡ åªæœ‰bubblesä¸ºtrueæ‰èƒ½è°ƒç”¨è¿™ä¸ªæ–¹æ³•
    stopPropagation(): void;
    readonly AT_TARGET: number;
    readonly BUBBLING_PHASE: number;
    readonly CAPTURING_PHASE: number;
    readonly NONE: number;
  
  	cancelBubble: boolean;  // IE æµè§ˆå™¨ only ç›¸å½“äº stopPropagation()
  	returnValue: boolean;   // IE æµè§ˆå™¨ only ç›¸å½“äº preventDefault()
  	srcELement: EventTarget // IE æµè§ˆå™¨ only ç›¸å½“äº target
}
```

å¯å‚è€ƒï¼š

- [dom events - whatwg](https://dom.spec.whatwg.org/#event)

**ğŸ§ğŸ§ğŸ§æ³¨æ„ `target`vs `currentTarget`çš„åŒºåˆ« **:  [currentTarget vs target - stackoverflow](https://stackoverflow.com/a/10086501)

- **`target`**: è§¦å‘äº‹ä»¶çš„å…ƒç´ 
- **`currentTarget`**: æ·»åŠ ç›‘å¬çš„å…ƒç´ 

åœ¨åé¢çš„äº‹ä»¶å§”æ‰˜ä¸­ï¼Œå°±å¯ä»¥çœ‹å‡ºåŒºåˆ«æ¥ï¼š

```html
<div id="div">
	<button id="btn">click</button>
</div>
```

js:

```js
const div = document.getElementById('div')
const button = document.getElementById('btn')

div.addEventListener('click', (e) => {
  console.log(`e.currentTarget: ${e.currentTarget}`)
  console.log(`e.target: ${e.target}`)
})

// ç›‘å¬äº‹ä»¶çš„å…ƒç´ æ˜¯ div
e.currentTarget: HTMLDivElement

// è§¦å‘äº‹ä»¶çš„å…ƒç´  button
e.target HTMLButtonElement
```



## 4. âš¡ï¸äº‹ä»¶ç±»å‹

ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç±»äº‹ä»¶ï¼š

1. âš¡ï¸ç”¨æˆ·ç•Œé¢äº‹ä»¶ï¼ˆ**`UIEvent`**ï¼‰: è®¾è®¡å’ŒBOMäº¤äº’çš„é€šç”¨æµè§ˆå™¨äº‹ä»¶
2. ç„¦ç‚¹äº‹ä»¶ ï¼ˆ**`FocusEvent`**ï¼‰: å…ƒç´ è·å¾—æˆ–å¤±å»ç„¦ç‚¹äº‹ä»¶
3. âš¡ï¸é¼ æ ‡äº‹ä»¶ï¼ˆ**`MouseEvent`**ï¼‰
4. æ»šåŠ¨äº‹ä»¶ï¼ˆ**`WheelEvent`**ï¼‰: æ»šåŠ¨é¼ æ ‡æ»šè½®æ—¶è§¦å‘
5. è¾“å…¥äº‹ä»¶ ï¼ˆ**`InputEvent`**ï¼‰: å‘æ–‡æ¡£è¾“å…¥æ–‡æœ¬æ—¶è§¦å‘
6. âš¡ï¸é”®ç›˜äº‹ä»¶ï¼ˆ**`KeyboardEvent`**ï¼‰: ä½¿ç”¨é”®ç›˜æ—¶è§¦å‘
7. åˆæˆäº‹ä»¶ï¼ˆ**`CompositionEvent`**ï¼‰: ä½¿ç”¨IME(è¾“å…¥æ³•ç¼–è¾‘å™¨)è¾“å…¥å­—ç¬¦æ—¶è§¦å‘

æ‰€æœ‰äº‹ä»¶å¯å‚è€ƒï¼š

- [å®Œæ•´äº‹ä»¶ç±»åˆ« - MDN](https://developer.mozilla.org/zh-CN/docs/Web/Events)

### 4.1 ç”¨æˆ·äº‹ä»¶ UIEvent

å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š

1. **`load`**: é¡µé¢åŠ è½½å®Œæˆåè§¦å‘ï¼Œæ¯”å¦‚ **`<frameset> | <frame> | <img> | <object>`** å…ƒç´ åŠ è½½å®Œæˆåè§¦å‘
2. **`unload`**: å½“é¡µé¢å®Œå…¨å¸è½½åè§¦å‘ï¼Œä»ä¸€ä¸ªé¡µé¢è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢æ—¶è§¦å‘ï¼Œ**å¯ä»¥æ¸…ç†ä¸€äº›å¼•ç”¨**
3. **`abort`**: **`<object>`** å…ƒç´ ä¸Šåœ¨åŠ è½½å‰ï¼Œç”¨æˆ·ç»ˆæ­¢ä¸‹è½½æ—¶è§¦å‘
4. **`error`**: **`<frameset> | <frame> | <img> | <object>`** å…ƒç´ æ— æ³•å®Œæˆæ—¶è§¦å‘
5. **`select`**: åœ¨æ–‡æœ¬æ¡†ï¼ˆ**`<input> | <textarea>`**ï¼‰ ä¸Šç”¨æˆ·é€‰æ‹©äº†ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦æ—¶è§¦å‘
6. **`resize`**: åœ¨windowæˆ–frameè¢«ç¼©æ”¾æ—¶è§¦å‘
7. **`scroll`**ï¼š å½“ç”¨æˆ·æ»šåŠ¨åŒ…å«æ»šåŠ¨æ¡çš„å…ƒç´ æ—¶åœ¨å…ƒç´ ä¸Šè§¦å‘ï¼Œä¸€èˆ¬ç”¨æ¥è·å– `scrollTop` æ•°æ®æ¥åšä¸€äº›åŠ¨ç”»æ•ˆæœä¹‹ç±»çš„

ä»¥ **`load`** äº‹ä»¶ä¸ºä¾‹ï¼š

å¯¹äº **`<img>`** å…ƒç´ ï¼š

```js
// html
// <img id="img" src="simple.jpg" />
const img = document.getElementById('src')
img.addEventListener('load', function(e) {
  console.log('å›¾ç‰‡åŠ è½½å®Œæˆ')
})
```

**ğŸ§ğŸ§ğŸ§ æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸‹è½½æŸä¸ªå›¾ç‰‡ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼**ï¼š ä½¿ç”¨ **`Image`** å¯¹è±¡å®ç°

```
// Imageå®šä¹‰
declare var Image: {
    new(width?: number, height?: number): HTMLImageElement;
};
```

å®ç°ï¼š

```js
window.addEventListener('load', () => {
  let image = new Image()
  image.addEventListener('load', (event) => {
    console.log('å›¾ç‰‡ä¸‹è½½å®Œæˆ')
  })
  // è®¾ç½®è¿™ä¸ªå±æ€§å æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨å¼€å§‹ä¸‹è½½å›¾ç‰‡
  image.src = 'some-pic.jpg'
})

// æˆ–è€…
window.addEventListener('load', () => {
  let img = document.createElement('img')
  img.addEventListener('load', (event) => {
    console.log('å›¾ç‰‡ä¸‹è½½å®Œæˆ')
  })
  document.body.appendChild(img) // è¿™ä¸ªå’Œå›¾ç‰‡ä¸‹è½½æ²¡æœ‰å…³ç³»
  // è®¾ç½®è¿™ä¸ªå±æ€§å æµè§ˆå™¨å°±ä¼šè‡ªåŠ¨å¼€å§‹ä¸‹è½½å›¾ç‰‡
  img.src = 'some-pic.jpg'
})
```



### 4.2 ç„¦ç‚¹äº‹ä»¶ FocusEvent

è·å–æˆ–è€…å¤±å»ç„¦ç‚¹ç›¸å…³çš„æ–¹æ³•ï¼š

- **`blur() & focus()`**
- **`document.hasFocus()`**: æ˜¯å¦æœ‰è·å–ç„¦ç‚¹çš„å…ƒç´ 
- **`document.activeElement`**: å½“å‰è·å–ç„¦ç‚¹çš„å…ƒç´ 

äº‹ä»¶ï¼š

1. **`blur`**: å¤±å»ç„¦ç‚¹ï¼Œ**ä¸å†’æ³¡**
2. **`focusout`**: å¤±å»ç„¦ç‚¹ï¼Œ **å†’æ³¡**
3. **`focus`**: è·å–ç„¦ç‚¹ï¼Œ **ä¸å†’æ³¡**
4. **`focusin`**: è·å–ç„¦ç‚¹ï¼Œ**å†’æ³¡**

å½“ç„¦ç‚¹ä»Aå…ƒç´ ä¸€åˆ°Bå…ƒç´ æ—¶ï¼Œäº‹ä»¶é¡ºåºï¼š

1. Aå…ƒç´  focusout
2. Bå…ƒç´  focusin
3. Aå…ƒç´  blur
4. Bå…ƒç´  focus

```js
// html
// <input id="input" type="text" />
const input = document.getElementById('input')
input.focus()

// ä½¿ç”¨å†’æ³¡ç‰ˆæœ¬äº‹ä»¶
document.addEventListener('focusin', (e) => {
	console.log(document.hasFocus())
  console.log(document.activeElement)
})

// æ‰“å°
true
HTMLInputElement // <input />
```



### 4.3 é¼ æ ‡äº‹ä»¶å’Œæ»šè½®äº‹ä»¶

è¿™ä¸ªæ˜¯PCç«¯æœ€å¸¸è§çš„ä¸€ç±»äº‹ä»¶ã€‚ä¸»è¦æœ‰ï¼š

1. **`click`**: é¼ æ ‡å•å‡»æˆ–è€…é”®ç›˜enteré”®è§¦å‘
2. **`dbclick`**: åŒå‡»æ—¶è§¦å‘
3. **`mousedown`**: æŒ‰ä¸‹ä»»æ„é¼ æ ‡é”®æ—¶è§¦å‘
4. **`mouseenter`**:  é¼ æ ‡å…‰æ ‡ä»å…ƒç´ å¤–éƒ¨ç§»åˆ°å…ƒç´ å†…éƒ¨æ—¶è§¦å‘ï¼Œ **ä¸å†’æ³¡**
5. **`mouseleave`**:  é¼ æ ‡å…‰æ ‡ä»å…ƒç´ å†…éƒ¨ç§»åˆ°å…ƒç´ å¤–éƒ¨æ—¶è§¦å‘ï¼Œ **ä¸å†’æ³¡**
6. **`mousemove`**: é¼ æ ‡å…‰æ ‡åœ¨å…ƒç´ ä¸Šç§»åŠ¨æ—¶åå¤è§¦å‘
7. **`mouseout`**: ç”¨æˆ·æŠŠé¼ æ ‡å…‰æ ‡ä»ä¸€ä¸ªå…ƒç´ ç§»åˆ°å¦ä¸€ä¸ªå…ƒç´ ä¸Šæ—¶è§¦å‘ã€‚**ç§»åˆ°çš„å…ƒç´ å¯ä»¥æ˜¯åŸå§‹å…ƒç´ çš„å¤–éƒ¨å…ƒç´ æˆ–è€…å…¶å­å…ƒç´ **ã€‚ åŒ…å« **`relatedTarget`** å±æ€§
8. **`mouseover`**: åœ¨ç”¨æˆ·æŠŠé¼ æ ‡å…‰æ ‡ä»å…ƒç´ å¤–éƒ¨ç§»åŠ¨åˆ°å…ƒç´ å†…éƒ¨æ—¶è§¦å‘ï¼Œ åŒ…å« **`relatedTarget`** å±æ€§
9. **`mouseup`**: åœ¨ç”¨æˆ·é‡Šæ”¾é¼ æ ‡æ—¶è§¦å‘
10. **`mousewheel`**: é¼ æ ‡æ»šåŠ¨äº‹ä»¶



**ğŸ§ğŸ§ğŸ§ å…³äº `mouseout` vs `mouseleave` åŒºåˆ«**ï¼š

- `mouseleave` ä¸å†’æ³¡ï¼Œ `mouseout` å†’æ³¡
- `mouseout` ç§»åˆ°çš„å…ƒç´ å¯ä»¥æ˜¯åŸå§‹å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶å­å…ƒç´ 

ç¤ºä¾‹ï¼š

```html
<style type="text/css">
#outer {
  width: 300px;
  height: 300px;
  background: #727333;
  display: flex;
  align-items: center;
  justify-content: center;
}

#inner {
  width: 100px;
  height: 100px;
  background: #733;
}
</style>
<div id="outer">
	<div id="inner" />
</div>
<script>
const outer = document.getElementById("outer");
const inner = document.getElementById("inner");

outer.addEventListener("mouseout", e => {
  console.log("mouseout");
});

outer.addEventListener("mouseleave", e => {
  console.log("mouseleave");
});
</script>
```

å½“é¼ æ ‡ä» **outer** ç§»åŠ¨åˆ° **inner** å­å…ƒç´ æ—¶ï¼Œä¼šè§¦å‘ `mouseout`  äº‹ä»¶ï¼Œè€Œä¸ä¼šè§¦å‘ `mouseleave` äº‹ä»¶ã€‚



**ğŸ§ğŸ§ğŸ§  `mouseenter` vs `mouseover` äº‹ä»¶åŒºåˆ«**ï¼š 

- `mouseenter` ä¸å†’æ³¡ï¼Œ `mouseover` å†’æ³¡

ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼š

```js
// ...
outer.addEventListener("mouseover", e => {
  console.log("mouseover");
});

outer.addEventListener("mouseenter", e => {
  console.log("mouseenter");
});

// å½“é¼ æ ‡ç§»åŠ¨åˆ° outerå…ƒç´ ä¸Šæ—¶ ä¼šè§¦å‘
mouseover
mouseenter

// å½“é¼ æ ‡ä» outer ç§»åŠ¨åˆ°å…¶å­å…ƒç´  innner æ—¶ï¼Œ å› ä¸º mouseover ä¼šå†’æ³¡ ä¼šè§¦å‘
mouseover
```

ç›¸å…³é˜…è¯»ï¼š

- [Moving the mouse: mouseover/out, mouseenter/leave](https://javascript.info/mousemove-mouseover-mouseout-mouseenter-mouseleave)
- [mouseenterä¸mouseoverä¸ºä½•è¿™èˆ¬çº ç¼ ä¸æ¸…ï¼Ÿ - æ˜é‡‘](https://juejin.cn/post/6844903480470028302)



> 1.é¼ æ ‡çš„å‡ ä¸ªåæ ‡

é¼ æ ‡ä½ç½®æœ‰å‡ ä¸ªåæ ‡ï¼š

1. **`clientX & clientY`** : é¼ æ ‡è·ç¦»æµè§ˆå™¨çª—å£åæ ‡
2. **`pageX & pageY`**: é¡µé¢è·ç¦»é¡¶éƒ¨çš„åæ ‡ï¼ŒåŒ…å«æ»šåŠ¨æ¡éƒ¨åˆ†
3. **`screenX & screenY`**: é¼ æ ‡åœ¨ç”µè„‘å±å¹•ä¸­çš„åæ ‡
4. **`offsetX & offsetY`**: é¼ æ ‡è·ç¦»å½“å‰å…ƒç´ åæ ‡ç³»ä¸­çš„åæ ‡

å¯ä»¥å‚è€ƒï¼š

- [âœ¨âœ¨âœ¨ clientX vs pageX vs screenX - segmentfault](https://segmentfault.com/a/1190000002405897)



> 2.ä¿®é¥°é”®

ä¸»è¦æ˜¯ **`shiftKey & ctrlKey & altKey & metaKey`**



> 3.é¼ æ ‡æŒ‰é”® âœ¨âœ¨âœ¨

**`event`** ä¸­åŒ…å« **`button`** å±æ€§ï¼Œä¸»è¦åŒ…å«3ä¸ªå€¼ï¼š

1. **`0`**: é¼ æ ‡ä¸»é”®(ä¸€èˆ¬å·¦é”®)
2. **`1`**: é¼ æ ‡ä¸­é”®(ä¸€èˆ¬æ»šè½®é”®)
3. **`2`**: é¼ æ ‡å‰¯é”®(ä¸€èˆ¬å³é”®)



> 4.æ»šè½®äº‹ä»¶

æ»šè½®äº‹ä»¶(**`mousewheel`**)ä¸­æœ‰ä¸€ä¸ª **`wheelDelta`** å±æ€§:

- é¼ æ ‡å‘ä¸Šæ¨ï¼Œè¿™ä¸ªå€¼ä¸º **è´Ÿæ•°**
- é¼ æ ‡å‘ä¸‹æ»‘ï¼Œè¿™ä¸ªå€¼ä¸º **æ­£æ•°**

```js
document.addEventListener('mousewheel', e => {
  console.log(e.wheelDelta)
})
```



### 4.4 é”®ç›˜å’Œè¾“å…¥äº‹ä»¶

ä¸»è¦æœ‰3ä¸ªäº‹ä»¶ï¼š

- **`keydown`**
- **`keypress`**
- **`keyup`**

è¾“å…¥äº‹ä»¶ï¼š

- **`textinput`**

äº‹ä»¶ä¸Šçš„éƒ¨åˆ†å±æ€§ï¼š

- **`keyCode`**: é”®ç ï¼Œæ¯ä¸ªé”®éƒ½æœ‰ä¸€ä¸ªç›¸å¯¹åº”çš„å€¼ï¼Œæ¯”å¦‚å›è½¦é”®çš„å€¼ä¸º `13`
- **`key`**: åŒ…å«çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ `shift + a` ä¼šè¾“å‡ºå¤§å†™ `A` (DOM3 ä¸æ¨èä½¿ç”¨)



### 4.5 HTML5äº‹ä»¶

è¿™ä¸ªæ˜¯H5ä¸­æ·»åŠ çš„ä¸€äº›äº‹ä»¶ï¼Œæ¯”è¾ƒé‡è¦çš„å‡ ä¸ªï¼š

1. **`contextmenu`** äº‹ä»¶ï¼Œä¸Šä¸‹æ–‡èœå•
2. **`beforeunload`** äº‹ä»¶ï¼š**å¯ä»¥ç”¨ä½œè·¯ç”±æ‹¦æˆªï¼Œæ¯”å¦‚ç¼–è¾‘æ–‡ç« æ—¶ï¼Œè¦ç¦»å¼€é¡µé¢æ—¶ï¼Œæç¤ºç”¨æˆ·æ˜¯å¦ä¿å­˜ä¹‹åå†é€€å‡ºå½“å‰é¡µé¢**
3. **`DOMContentLoaded`** äº‹ä»¶ï¼š DOMæ ‘æ„å»ºå®Œæˆåç«‹å³è§¦å‘ï¼Œä¸ç”¨ç­‰å¾…å›¾ç‰‡ï¼ŒJSï¼ŒCSSç­‰èµ„æºåŠ è½½å®Œæˆï¼Œ**è¿™ä¸€ç‚¹è¦å’Œ `load` äº‹ä»¶åŒºåˆ†å¼€æ¥**
4. **`hashchange`** äº‹ä»¶ï¼šå½“hashå‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼Œ **è¿™ä¸ªæ˜¯ç°åœ¨å•é¡µé¢è·¯ç”±ä¸­ç»å¸¸ç”¨åˆ°çš„**ï¼ŒåŒ…å« `oldURL & new URL` å±æ€§



ç¤ºä¾‹1: 

```js
const outer = document.getElementById("app");

outer.addEventListener("contextmenu", e => {
  e.preventDefault();
  let menu = document.getElementById("myMenu");
  menu.style.left = event.clientX + "px";
  menu.style.top = event.clientY + "px";
  menu.style.visibility = "visible";
});

outer.addEventListener("click", e => {
  if (e.button === 2) { // å¦‚æœä½¿ç”¨çš„æ˜¯é¼ æ ‡å³é”® åˆ™æ˜¾ç¤ºcontextmenu
    document.getElementById("myMenu").style.visibility = "visible";
  } else {
    document.getElementById("myMenu").style.visibility = "hidden";
  }
});
```

å¯å‚è€ƒï¼š [å®ç°è‡ªå®šä¹‰å³é”®èœå•ï¼ˆContext Menuï¼‰ contextmenu](https://cloud.tencent.com/developer/article/1656903)



æ‰©å±•é˜…è¯»ï¼š

1. [hashchangeäº‹ä»¶ - ç®€ä¹¦](https://www.jianshu.com/p/100242c095e7)



## 5. äº‹ä»¶å§”æ‰˜

äº‹ä»¶å§”æ‰˜ä¸»è¦åˆ©ç”¨ **äº‹ä»¶å†’æ³¡**ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªçˆ¶å…ƒç´ æ¥ç›‘å¬å…¶å­ç±»äº‹ä»¶ã€‚å¯ä»¥å‡å°‘äº‹ä»¶ç›‘å¬æ•°é‡ï¼Œæé«˜æ€§èƒ½ã€‚

```html
<ul id="links">
  <li id="link-1">item 1</li>
  <li id="link-2">item 2</li>
  <li id="link-3">item 3</li>
</ul>
```

äº‹ä»¶å§”æ‰˜ï¼š

```js
const links = document.getElementById('links')
links.addEventListener('click', e => {
  let target = e.target // äº‹ä»¶è§¦å‘çš„å…ƒç´ 
  
  switch(target.id) {
    case 'link-1':
      // ...
      break
    case 'link-2':
      // ...
      break
    case 'link-3':
      // ...
  }
})
```

æ‰©å±•é˜…è¯»ï¼š

- [JavaScript äº‹ä»¶å§”æ‰˜è¯¦è§£ - æ˜é‡‘](https://juejin.cn/post/6844903475470417928)



## 6. æ¨¡æ‹Ÿäº‹ä»¶

äº‹ä»¶å®é™…ä¸Šæ˜¯ä¸€ç§å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå¯ä»¥ç”¨æ¥è§£è—•ï¼Œæˆ‘ä»¬æ ¹æ®éœ€æ±‚ï¼Œè‡ªå®šä¹‰äº‹ä»¶ã€‚

ä¸€èˆ¬åšæ³•æ ¹æ®äº‹ä»¶ç±»å‹æ¥åˆ›å»ºå·²ç»å­˜åœ¨çš„äº‹ä»¶ç±»å‹ï¼š **`createEvent()`** åˆ›å»ºäº‹ä»¶ï¼› **`dispatchEvent()`**: è§¦å‘äº‹ä»¶

- **`MouseEvent`**: å¯¹åº” `initMouseEvent()`
- **`KeyboardEvent`**: å¯¹åº” `initKeyboardEvent()`
- **`HTMLEvents`**

```js
const div = document.getElementById('box')
// è‡ªå®šä¹‰é¼ æ ‡äº‹ä»¶ MouseEvent
const clickEvent = document.createEvent('MouseEvent')
clickEvent.initMouseEvent('click', true, true, document.defaultView)
div.dispatchEvent(clickEvent) // è§¦å‘äº‹ä»¶
```

ä½¿ç”¨ `Event` æ–¹å¼ï¼š

```js
const event = new Event('look', {
  bubbles: false, // ä¸æ”¯æŒå†’æ³¡
  cancelable: false // ä¸å¯å–æ¶ˆ
})
document.dispatchEvent(event)
myDiv.dispatchEvent(event)
```



**`CustomEvent()`** è‡ªå®šä¹‰äº‹ä»¶ï¼Œ**å¯ä»¥é€šè¿‡ `detail` ä¼ é€’ä¿¡æ¯**ï¼Œå…¶å®ƒå±æ€§ï¼š

- **`type`**: è‡ªå®šä¹‰äº‹ä»¶å

- **`bubbles`**: æ˜¯å¦å…è®¸å†’æ³¡
- **`cancelable`**: äº‹ä»¶æ˜¯å¦å¯å–æ¶ˆ
- **`detail`**: å¯¹è±¡ï¼Œé»˜è®¤å€¼æ˜¯null

ç¤ºä¾‹ï¼š

```js
const loginEvent = new CustomEvent('login', {
  bubbles: true,
  cancelable: true,
  detail: {
    username: 'lili',
    password: '123456'
  }
})
document.dispatchEvent(loginEvent)

myDiv.addEventListener('login', e => {
  console.log(e.detail) // {username: 'lili',password: '123456'}
})


// ä»¥å‰çš„å†™æ³•
const loginEvent = document.createEvent('CustomEvent')
loginEvent.initCustomEvent('login', true, true, { username: 'lili', password: '123456'})
document.dispatchEvent(loginEvent)
```

ç›¸å…³æ–‡æ¡£å’Œæ–‡ç« ï¼š

1. [CustomEvent - MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/CustomEvent)
2. [Document.createEvent() - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Document/createEvent#Notes)
3. [Event() - MDN](https://developer.mozilla.org/zh-CN/docs/Web/API/Event/Event)
4. [âœ¨âœ¨âœ¨ javascriptè‡ªå®šä¹‰äº‹ä»¶åŠŸèƒ½ä¸ç”¨æ³•å®ä¾‹åˆ†æ - æ˜é‡‘](https://juejin.cn/post/6844903590906036232)
5. [JavaScript Pattern: Using Custom Events - youtube](https://www.youtube.com/watch?v=KuEVmf-Fxk0&ab_channel=AllThingsJavaScript%2CLLC)
6. [How to Make Custom Event Listeners in JavaScript - blog](https://www.webtips.dev/how-to-make-custom-event-listeners-in-javascript)



æ€»ä½“æ¥è¯´ï¼Œäº‹ä»¶ç”¨å¾—æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œä¸€äº›æ¦‚å¿µè¿›è¡ŒåŒºåˆ†è¿˜æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚è‡ªå®šä¹‰äº‹ä»¶ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä¸€èˆ¬åœ¨è‡ªå®šä¹‰åº“ä¸­æ¯”è¾ƒå¸¸è§ï¼Œäº†è§£å®ƒï¼Œå¯ä»¥æ›´å¥½çš„å»å®ç°è‡ªå®šä¹‰ç›®æ ‡ã€‚



2020-12-16 21:46:56